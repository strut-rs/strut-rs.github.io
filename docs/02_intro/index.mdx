---
sidebar_position: 2
slug: /
---

# Intro

[docs-config]: /docs/config
[docs-components]: /docs/components
[docs-components-tracing]: /docs/components/tracing
[docs-custom]: /docs/custom

[rust]: https://www.rust-lang.org/
[cargo-book]: https://doc.rust-lang.org/cargo/
[cargo-book-features]: https://doc.rust-lang.org/cargo/reference/features.html
[externalized-config]: https://www.12factor.net/config
[async-runtime]: https://rust-lang.github.io/async-book/08_ecosystem/00_chapter.html
[tokio-runtime]: https://docs.rs/tokio/latest/tokio/runtime/struct.Runtime.html

[crates-io-strut]: https://crates.io/crates/strut
[crates-io-config]: https://crates.io/crates/config
[crates-io-tokio]: https://crates.io/crates/tokio
[crates-io-smol]: https://crates.io/crates/smol
[crates-io-serde]: https://crates.io/crates/serde
[crates-io-dotenvy]: https://crates.io/crates/dotenvy
[crates-io-parking-lot]: https://crates.io/crates/parking_lot

[docs-rs-strut-launchpad]: https://docs.rs/strut/latest/strut/struct.Launchpad.html
[docs-rs-strut-runtime-wiring]: https://docs.rs/strut/latest/strut/trait.RuntimeWiring.html

## What is Strut?

:::note
This documentation assumes basic understanding of the [_Rust_][rust] programming language and [_Cargo_][cargo-book], the Rust package manager.
If you are completely new, follow the links to learn about these wonderful tools.
:::

Strut refers to the [`strut`][crates-io-strut] crate.
It’s main job is to simplify common backend chores:

- Startup:
    - Load [externalized configuration][externalized-config].
    - Build [asynchronous runtime][async-runtime].
    - Initialize logging/tracing.
    - Set up integrations with external systems.
- Spindown:
    - Release held resources.
    - Close external connections.

### What’s included by default

The `strut` crate has many [features][cargo-book-features], but none of them are enabled by default.
At the baseline, these well-known crates are always pulled in by Strut:

- [`config`][crates-io-config]: to load the application config from files & environment.
- [`tokio`][crates-io-tokio]: to build the asynchronous runtime for the application.
- [`serde`][crates-io-serde]: to conveniently deserialize the external config.
- [`dotenvy`][crates-io-dotenvy]: to support environment defaults from `.env` files.
- Implementation details, such as [`parking_lot`][crates-io-parking-lot].

:::info[Tokio?]
Yes, Strut requires an asynchronous runtime, and makes an opinionated choice for [Tokio][crates-io-tokio].
This comes from the fact that almost all Strut components have some sort of `async` play in them.

No, there is no option to switch to alternatives such as [`smol`][crates-io-smol].
Tokio is a robust, well-maintained, and widely adopted runtime.
Additionally, the kind of applications that Strut aims at are not expected to bottleneck their performance on runtime choice.
:::

:::info[Bare metal?]
Strut is not designed for bare-metal applications, a.k.a. no-`std`, or embedded systems without an OS.

Instead, Strut targets the “classical” backend applications: web/API servers, macro-/microservices, data processors, etc., where the binary size is not expected to be a constraining factor.
:::

## Install Strut

Adding Strut to a binary crate is as simple as:

1. Add Strut dependency with `cargo add strut`.
2. Prefix the `#[strut::main]` attribute to the main function, and make it `async`.

```rust title="src/main.rs"
#[strut::main]
async fn main() {
    // ...
}
```

:::info[Already using Tokio?]
It’s ok to replace the `#[tokio::main]` attribute with `#[strut::main]`.
The latter wraps and includes the former.

If the Tokio runtime needs to be customized, this is possible using a custom [`RuntimeWiring`][docs-rs-strut-runtime-wiring].
:::

### Launchpad

The `#[strut::main]` attribute is designed for simplistic use-cases.
It is equivalent to:

```rust
fn main() {
    let body = async {
        // ...
    };
    strut::App::boot(body);
}
```

The call to the `App::boot` method is itself equivalent to:

```rust
fn main() {
    let body = async {
        // ...
    };
    strut::Launchpad::new(body).boot();
}
```

The [`Launchpad`][docs-rs-strut-launchpad] object exposes a number of pre-boot customizations.
If you want to customize how Strut boots the application, `Launchpad` should be the first thing to look at.

### Next steps

The base Strut dependency spins up a [Tokio runtime][tokio-runtime] and loads the [application configuration][docs-config].
Without any [components][docs-components], the configuration is practically empty.
Adding a component, such as [`tracing`][docs-components-tracing] is the logical next step.

For crates and use-cases not yet baked into Strut, [custom integrations][docs-custom] are possible.
